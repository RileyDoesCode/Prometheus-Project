<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prometheus Lua Obfuscator</title>

<style>
:root{
--bg:#0d1117;
--box:#161b22;
--text:#c9d1d9;
--accent:#58a6ff;
--border:#30363d;
--btn:#21262d;
--btnhover:#30363d;
}

body{
background:var(--bg);
color:var(--text);
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif;
margin:0;
padding:20px;
display:flex;
flex-direction:column;
align-items:center;
}

h1{color:var(--accent)}

.main{
width:100%;
max-width:900px;
display:flex;
flex-direction:column;
gap:20px;
}

textarea{
width:100%;
height:250px;
background:var(--box);
color:#7ee787;
border:1px solid var(--border);
border-radius:6px;
padding:15px;
font-family:Consolas,monospace;
font-size:14px;
resize:vertical;
box-sizing:border-box;
outline:none;
}

textarea:focus{border-color:var(--accent)}

button{
background:var(--btn);
color:var(--text);
border:1px solid var(--border);
border-radius:6px;
padding:8px 16px;
font-weight:600;
cursor:pointer;
}

button:hover{background:var(--btnhover)}

.primary{
background:#238636;
border:none;
color:white;
padding:12px;
}

.primary:hover{background:#2ea043}

.bar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:5px;
gap:10px;
}

.group{display:flex;gap:10px}

.loading{
opacity:0.6;
pointer-events:none;
}
</style>
</head>
<body>

<h1>Prometheus Obfuscator</h1>

<div class="main">

<div>
<div class="bar">
<label>Input Lua Script</label>
<button onclick="pasteText()">Paste</button>
</div>
<textarea id="input"></textarea>
</div>

<button id="run" class="primary" onclick="obfuscate()">Obfuscate</button>

<div>
<div class="bar">
<label>Obfuscated Result</label>
<div class="group">
<button onclick="copyText()">Copy</button>
<button onclick="downloadText()">Download</button>
</div>
</div>
<textarea id="output" readonly></textarea>
</div>

</div>

<script>
const input = document.getElementById("input");
const output = document.getElementById("output");
const btn = document.getElementById("run");

async function pasteText(){
try{
input.value = await navigator.clipboard.readText();
}catch{
alert("Clipboard denied.");
}
}

async function obfuscate(){
if(!input.value.trim()) return alert("Enter Lua code first.");

btn.classList.add("loading");
btn.innerText="Processing...";
output.value="Obfuscating...";

try{
const res = await fetch("/obfuscate",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({code:input.value})
});

const data = await res.json();

if(res.ok){
output.value=data.result;
}else{
output.value="ERROR:\n"+(data.details||data.error);
}

}catch(e){
output.value="NETWORK ERROR:\n"+e.message;
}

btn.classList.remove("loading");
btn.innerText="Obfuscate";
}

function copyText(){
if(!output.value) return;
navigator.clipboard.writeText(output.value);
alert("Copied.");
}

function downloadText(){
if(!output.value) return;
const blob=new Blob([output.value],{type:"text/plain"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="obfuscated.lua";
a.click();
}
</script>

</body>
</html>
